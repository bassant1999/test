{% load static %}
<!DOCTYPE html>

<html lang="en">

<head>
    <link rel="icon" href="{% static 'book_heaven/icon.png' %}">
    <title>
        Signup
    </title>
    <!-- viewport match the devices's width -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <!-- link to stylesheet -->
    <link rel="stylesheet" href="{% static 'book_heaven/styles.css' %}">
    <!-- link to js -->
    <script src="{% static 'book_heaven/reading.js' %}"></script>
    <!-- bootstrap CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/css/bootstrap.min.css"
        integrity="sha384-TX8t27EcRE3e/ihU7zmQxVncDAy5uIKz4rEkgIXeMed4M0jlfIDPvg6uqKI2xXr2" crossorigin="anonymous">
    <!-- fontwesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <script src="https://code.jquery.com/jquery-3.5.1.min.js"
        integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>

    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js" type="text/javascript"></script>

    <link rel="stylesheet" href="{% static 'book_heaven/select2.min.css' %}">
    <script src="{% static 'book_heaven/select2.min.js' %}"></script>

    <script>
        // $(document).ready(function () {
        //     $('.fisa').select2({
        //         minimumInputLength: 4,
        //         allowClear: true,
        //         placeholder: ''
        //     });
        //     $('.pisa').select2({
        //         minimumInputLength: 4,
        //         allowClear: true,
        //         placeholder: ''
        //     });
        // });
        document.addEventListener('DOMContentLoaded', function () {
            $('.fisa').select2({
    
                minimumInputLength: 4,
                allowClear: true,
                placeholder: ''
            });
            $('.pisa').select2({
    
                minimumInputLength: 4,
                allowClear: true,
                placeholder: ''
            });
            // alert("isaaaaaaaaaaaaa")
        });
    
    
    </script>
    <script>
        function signup() {
    
    
    
            const books = document.querySelector('.signup_book');
            const children_arr = books.children;
            let res = [];
            var book_title;
    
    
            temp1 = children_arr[0].children[0];
            temp2 = children_arr[0].children[2];
            const book_title1 = $("#" + temp1.id).find(':selected').text();
            rating1 = document.getElementById(temp2.id);
            const rating_1 = parseInt(rating1.options[rating1.selectedIndex].text);
            res.push(book_title1);
            res.push(rating_1);
    
            temp3 = children_arr[1].children[0];
            temp4 = children_arr[1].children[2];
            const book_title2 = $("#" + temp3.id).find(':selected').text();
            rating2 = document.getElementById(temp4.id);
            const rating_2 = parseInt(rating2.options[rating2.selectedIndex].text);
            res.push(book_title2);
            res.push(rating_2);
    
            temp5 = children_arr[2].children[0];
            temp6 = children_arr[2].children[2];
            const book_title3 = $("#" + temp5.id).find(':selected').text();
            rating3 = document.getElementById(temp6.id);
            const rating_3 = parseInt(rating3.options[rating3.selectedIndex].text);
            res.push(book_title3);
            res.push(rating_3);
    
            temp7 = children_arr[3].children[0];
            temp8 = children_arr[3].children[2];
            const book_title4 = $("#" + temp7.id).find(':selected').text();
            rating4 = document.getElementById(temp8.id);
            const rating_4 = parseInt(rating4.options[rating4.selectedIndex].text);
            res.push(book_title4);
            res.push(rating_4);
    
            temp9 = children_arr[4].children[0];
            temp10 = children_arr[4].children[2];
            const book_title5 = $("#" + temp9.id).find(':selected').text();
            rating5 = document.getElementById(temp10.id);
            const rating_5 = parseInt(rating5.options[rating5.selectedIndex].text);
            res.push(book_title5);
            res.push(rating_5);
    
            temp11 = children_arr[5].children[0];
            temp12 = children_arr[5].children[2];
            const book_title6 = $("#" + temp11.id).find(':selected').text();
            rating6 = document.getElementById(temp12.id);
            const rating_6 = parseInt(rating6.options[rating6.selectedIndex].text);
            res.push(book_title6);
            res.push(rating_6);
            // alert(res)
            if (((res[0] === res[2]) || (res[0] === res[4]) || (res[4] === res[2])) || ((res[6] === res[8]) || (res[6] === res[10]) || (res[8] === res[10]))) {
                if (document.getElementById("no")) {
                    return
                }
                const btn = document.createElement("div");
                btn.innerHTML = "choose different books!";
                btn.setAttribute("id", "no");
                document.body.appendChild(btn);
    
                return
            }
            console.log(res);
            $.ajax({
                type: "GET",
                url: 'signup_continue',
                data: {
                    "result[]": res
                },
            });
    
            window.location.href = "login";
    
        }
        document.addEventListener('DOMContentLoaded', function () {
            var fbooks = JSON.parse('{{ fbooks_js|escapejs }}');
            var pbooks = JSON.parse('{{ pbooks_js|escapejs }}');
            // alert(typeof faya);
            // pbooks = document.querySelector(".pbooks").id;
            // fbooks = document.querySelector(".fbooks").id;
            // alert(pbooks)
            // clearList();
            var a = document.querySelector("#book4_t");
            var b = document.querySelector("#book5_t");
            var f = document.querySelector("#book6_t");
            var p1 = document.querySelector("#book1_t");
            var p2 = document.querySelector("#book2_t");
            var p3 = document.querySelector("#book3_t");
            var htmlf = "";
            var htmlp = "";
            for (var i = 0; i < fbooks.length; i++) {
                htmlf += "<option value='" + fbooks[i] + "'>" + fbooks[i] + "</option>";
            }
            $(a).html(htmlf);
            $(b).html(htmlf);
            $(f).html(htmlf);
            for (var i = 0; i < pbooks.length; i++) {
                htmlp += "<option value='" + pbooks[i] + "'>" + pbooks[i] + "</option>";
            }
            $(p1).html(htmlp);
            $(p2).html(htmlp);
            $(p3).html(htmlp);
    
        });
    
    </script>

</head>

<body>
    <a href="{% url 'signup_1' %}">Signup</a>
    <br/>
    <a href="{% url 'login' %}">Log in</a>
    <div class="signup_book">
        <p> Choose three paid books you already read and rate them </p>
        <div>
            <select class="pisa" id="book1_t" style="margin: 20px ; width: 1000px;">
                <!-- {% for paid_book in pbooks %}
                <option value="{{paid_book.title}}"> {{paid_book.title}} </option>
                {% endfor %} -->
            </select>
            <select id="book1_r">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </div>
        <div>
            <select class="pisa" id="book2_t" style="margin: 20px ; width: 1000px;">
                <!-- {% for paid_book in pbooks %}
                <option value="{{paid_book.title}}"> {{paid_book.title}} </option>
                {% endfor %} -->
            </select>
            <select id="book2_r">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </div>
        <div>
            <select class="pisa" id="book3_t" style="margin: 20px ; width: 1000px;">
                <!-- {% for paid_book in pbooks %}
                <option value="{{paid_book.title}}"> {{paid_book.title}} </option>
                {% endfor %} -->
            </select>
            <select id="book3_r">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </div>
        <p> Choose three free books you already read and rate them </p>
        <div>
            <select class="fisa" id="book4_t" style="margin: 20px; width: 1000px;">
                <!-- {% for free_book in fbooks %}
                <option value="{{free_book.title}}"> {{free_book.title}} </option>
                {% endfor %} -->
            </select>
            <select id="book4_r">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </div>
        <div>
            <select class="fisa" id="book5_t" style="margin: 20px; width: 1000px; ">
                <!-- {% for free_book in fbooks %}
                <option value="{{free_book.title}}"> {{free_book.title}} </option>
                {% endfor %} -->
            </select>
            <select id="book5_r">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </div>
        <div>
            <select class="fisa" id="book6_t" style="margin: 20px; width: 1000px;">
                <!-- {% for free_book in fbooks %}
                <option value="{{free_book.title}}"> {{free_book.title}} </option>
                {% endfor %} -->
            </select>
            <select id="book6_r">
                <option value="1">1</option>
                <option value="2">2</option>
                <option value="3">3</option>
                <option value="4">4</option>
                <option value="5">5</option>
            </select>
        </div>
        <button id="signup" onclick="signup()">signup</button>


    </div>

</body>

</html>